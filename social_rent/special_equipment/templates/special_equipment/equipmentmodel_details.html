{% extends 'special_equipment/base.html' %}
{% load static %}
{% block title %}{{ equipment_model.model_name }} | {{ block.super }}{% endblock title %}

{% block content %}
    <div class="container py-3">
        <h1>{{ equipmentmodel.model_name }}</h1>
        <a href="{% url 'typeurl' equipmentmodel.type.id %}"><h2>{{ equipmentmodel.type }}</h2></a>
        <div class="d-flex p-2 bg-light small">
            {% if equipmentmodel.category.count > 0 %}
                <span class="flex-shrink-1">Kategorijos:</span>
                {% for kategorija in equipmentmodel.category.all %}
                    <span class="badge badge-pill badge-secondary ml-1">{{ category }}</span>
                {% endfor %}
            {% else %}
                <span class="flex-shrink-1">Kategorija neapibrėžta</span>
            {% endif %}

        </div>
        {#
    {% if book.cover %}
        <img style="max-width: 400px;" class="img-fluid img-thumbnail float-right ml-3" src="{{ book.cover.url }}">
    {% else %}
        <img style="max-width: 400px;" class="img-fluid img-thumbnail float-right ml-3" src="{% static 'books/img/vibrant-abstract-book-cover.jpg' %}">
    {% endif %}
    #}
    <p>{{ equipmentmodel.summary|safe }}</p>

    <h3> Ar yra galimybė gauti "{{ equipmentmodel.model_name }}"? </h3>
    {% if equipment_model.equipment_units.count > 0 %}
        <div class="list-group">
            {% for model_unit in equipment_model.equipment_units.all %}
            <div class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                <span class="flex-grow-1">{{ model_unit.id }}</span>
                <span class="badge 
                {% if model_unit.status == 'ok' %}badge-success
                {% elif model_unit.status == 'kt' %}badge-secondary
                {% elif model_unit.status == 'r' %}badge-danger
                {% else %}badge-warning{% endif %}
                badge-pill ml-1">{{ model_unit.get_status_display }}</span>
                {% if model_unit.status == 'p' %}
                <span class="ml-2">bus grąžinta: {{ model_unit.returning_date }}</span>
                {% endif %}
            </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="alert alert-secondary">Dėl galimybės gauti šį modelį prašome teirautis telefonu</div>
    {% endif %}

    <h3>Atsiliepimai</h3>
    {% if equipmentmodel.equipment_model_comments.count > 0%}
        {% for comment in equipmentmodel.equipment_model_comments.all %}
        <div class="card">
            <div class="card-body">
                <span class="text-muted float-right">{{ comment.created_at }}</span>
                <h5 class="card-title">{{ comment.reviewer }}</h5>
                {{ comment.content|safe }}
            </div>
        </div>
        {% endfor %}
    {% else %}
        <div class="alert alert-secondary"> Apie šį modelį atsiliepimų nėra </div>
    {% endif %}
    {% if user.is_authenticated %}
    <div class="FieldWrapper">
        <h4>Palikite Atsiliepimą</h4>
        <form method="post" action="">
            {% csrf_token%}
            {{ form.content }}<br/>
            <input type="submit" value="išsaugoti" class="btn btn-primary">
        </form>
    </div>
    {% endif %}

    </div>
{% endblock content %}

